"use strict";var FROG={},OPTIONS={FLOWMAX:0,PERPAGE:100,TEMPLATE:"article-full"};Object.defineProperty(FROG,"FLOWS",{get:(()=>{var a=0;return()=>a++})()});var importScript=function(a){var b=new XMLHttpRequest;b.onload=function(){if(0<this.responseText.length)eval.call(window,this.responseText);else throw new Error("Impossible to load script "+a)},b.onerror=function(){throw new Error("Impossible to load script "+a)},b.open("GET",a,!1),b.send(null)},__=function(a){return"/_._._/engine/"+(a||"")},_s=function(a){return"/_._._/styles/frog/"+(a||"")},_i=function(a){return"/_._._/images/"+(a||"")},_a=function(a){return"/_._._/articles/"+(a||"")},_t=function(a){return"/_._._/templates/"+(a||"")},error=console.error,warning=console.warn;Element.prototype.getAttributeNames==null&&(Element.prototype.getAttributeNames=function(){for(var a=this.attributes,b=a.length,c=Array(b),d=0;d<b;d++)c[d]=a[d].name;return c});var EventListen=function(){this.events={},this.addEventListener=function(a,b){this.events[a]=this.events[a]||[],this.events[a].push(b)},this.removeEventListener=function(a,b){if(this.events[a]!==void 0){let c=this.events[a];for(let a=0;a<c.length;a++)if(c[a]==b){c.splice(a,1);break}}},this.fireEvent=function(a,b){if(this.events[a]){let c=this.events[a];for(let a=0;a<c.length;a++)c[a](b)}}},hookedProperty=function(a,b,c){"use strict";let d=c;Object.defineProperty(this,b,{set:b=>{d=b,a(b)},get:()=>d})},immutableProperty=function(a,b){Object.defineProperty(this,a,{get:()=>b})},UrlHash=(()=>{var a={},b={};return a.read=()=>{window.location.hash.replace("#","").split("&").forEach(function(a){let c=a.split("=");if(c[0]&&c[1]){let a=decodeURIComponent(c[1]);try{a=JSON.parse(decodeURIComponent(c[1]))}catch(a){}b[c[0]]=a}})},a.write=()=>{let a="#",c=[];Object.keys(b).forEach(a=>{let d=b[a];"object"==typeof d&&(d=JSON.stringify(d)),c.push(a+"="+encodeURIComponent(d))}),a+=c.join("&"),window.location.hash=a},a.get=c=>(a.read(),b[c]),a.set=(c,d)=>{"object"==typeof c?b=Object.assign(b,c):b[c]=d,a.write()},Object.defineProperty(a,"list",{get:()=>{let a={};return Object.keys(b).forEach(c=>{a[c]=b[c]}),a}}),window.addEventListener("load",a.read()),a})(),Cache=(()=>{var a={},b={};a.get=a=>b[a],a.set=(a,d)=>{b[a]=d,c(a,d)},a.has=a=>!!b[a];let c=(a,b)=>{for(let c=0;;)try{window.sessionStorage.setItem(a,b);break}catch(a){let b=window.sessionStorage.key(c++);window.sessionStorage.removeItem(b)}};return window.addEventListener("load",()=>{for(let a=0;a<window.sessionStorage.length;a++){const c=window.sessionStorage.key(a);b[c]=window.sessionStorage.getItem(c)}}),a})();String.prototype.replaceParams||(String.prototype.replaceParams=function(){return this.replace(/(\$([^ ]+))/g,function(a,b,c){return UrlHash.get(c)||""})});var Sorting={natural:function(c,a){return c.localeCompare(a)},reverse:function(c,a){return a.localeCompare(c)},random:function(){return .5<Math.random?-1:1}};HTMLElement.prototype.remove||(HTMLElement.prototype.remove=function(){this.parentElement.removeChild(this)}),HTMLElement.prototype.replace||(HTMLElement.prototype.replace=function(a){this.insertAdjacentHTML("beforebegin",a),this.remove()});var Request=function(a,b){b=b||!1;var c={};return c.req=new XMLHttpRequest,c.Future=new Future,c.onLoaded=function(){},c.loaded=function(a){return c.onLoaded=a,c},c.processResponse=function(a){return a},c.req.onload=function(a){if(200===this.status)try{c.Future.value=c.processResponse(this),c.onLoaded(c.Future.value)}catch(a){c.onFailed()}else c.onFailed(a)},c.onFailed=function(){},c.failed=function(a){return c.onFailed=a,c},c.req.onerror=function(b){console.error("Ajax Error "+b.target.status+" from "+a),c.onFailed(b)},c.send=function(){return c.req.open("GET",a,!b),c.req.send(null),c.Future},c},fhtml=function(a){return a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a},getJson=function(a,b){var c=Request(a,b);return c.processResponse=function(a){return JSON.parse(a.responseText)},c},getText=function(a,b){var c=Request(a,b);return c.processResponse=function(a){return a.responseText},c},Async={newHash:function(){var a=0;return function(){return a++}}()},Workers={get FUNCTION(){return new Worker(__("async/workers/function_worker.js"))},get MENO(){return new Worker(__("async/workers/parser_worker.js"))}},AsyncTask=function(a,b,...c){this.url=script,this.name=b,this.args=c,this.hash=Async.newHash()},AsyncFunction=function(a,...b){this.task=a.toString(),this.args=b||[],this.hash=Async.newHash()},AsyncParse=function(a){this.raw=a,this.hash=Async.newHash()},WorkerPool=function(a,b){EventListen.call(this);var c,d=this,e=[],f=[],g=[];b=0<b?b:0,this.last=!1,this.hasWork=function(){return 0!=c},this.terminate=function(){clearInterval(e);for(let a=0;a<g.length;a++)g[a].o.terminate()},this.postMessage=function(a){var b=a.data;f.push(b)};var h=function(){let c={free:!0,o:new Worker(a)},e=function(a){let e=a.data;c.free=!0,j.call(d,e),0==b&&c.o.terminate()};return c.event||(c.o.addEventListener("message",e),c.event=!0),c},i=function(){if(0==b||g.length<b){let a=h();return g.push(a),a}else{let b=new Future,c=e.length;var a=function(){for(let a=0;a<g.length;a++)if(!0==g[a].free)return b.value=g[a],g[a].free=!1,void clearInterval(e[c])};return e.push(setInterval(a,10)),b}},j=function(a){this.fireEvent("message",new MessageEvent("worker",{data:a})),c--,this.last&&0==c&&this.terminate()},k=function(a){let b=i();b instanceof Future?b.echo(function(b){b.free=!1,b.o.postMessage(a)}):(b.free=!1,b.o.postMessage(a))};this.startAll=function(){c=f.length;for(let a=0;a<f.length;a++)k(f[a])},this.startOne=function(a){c=f.length;for(let b=0;b<f.length;b++)f[b].hash==a&&k(f[b])}},Future=function(a){EventListen.call(this);var b=a||null;Object.defineProperty(this,"value",{get(){return b},set(a){this.fireEvent("value",new MessageEvent("future",{data:a})),b=a,e()},enumerable:!0,configurable:!0});var c=function(a){b=a},d=[],e=function(){for(let a,e=0;e<d.length&&(a=d[e](b,c),!1!==a);e++)"number"==typeof a&&(e=0>e+a?0:e+a)};this.echo=function(a){d=[],d.push(a);let b={then:f.bind(this)};return null!=this.value&&e(),b};var f=function(a){d.push(a);let b={then:f.bind(this)};return null!=this.value&&e(),b}},FuturePool=function(){EventListen.call(this);let a,b=0,c=()=>{};this.add=function(a){if(a instanceof Future)return b++,a.addEventListener("value",()=>{b--,d()}),this},this.done=function(a){this.add=()=>{},c=a,d.bind(this)()};let d=function(){0==b&&(clearTimeout(a),c())};this.clearTimeout=function(){clearTimeout(a)},this.setTimeout=function(a,b,d=!1){return this.clearTimeout(),setTimeout(()=>{d&&(c=()=>{}),b()},a),this}},Process=function(a){var b=null,c=a.hash,d=!1;this.worker=function(c){if(b=c,c instanceof Worker)return this.start=g,this.pool=void 0,this.worker=void 0,this.last=function(){return d=!0,this},this.done=function(c){return b.functions=b.functions||{},b.functions[a.hash]=c,this},this;throw new Error("Process worker must be a Worker")},this.pool=function(d){if(d instanceof WorkerPool)return b=d,this.startAll=f,this.pool=void 0,this.worker=void 0,this.last=function(){return b.last=!0,this},this.start=function(){e(),b.startOne(c)},this.done=function(c){return b.functions=b.functions||{},b.functions[a.hash]=c,this},b.postMessage(new MessageEvent("worker",{data:a})),this;throw new Error("Process pool must be a WorkerPool")};var e=function(){if(null==b)return void console.warn("The process "+a+" has no Worker !");b.event||(b.addEventListener("message",function(a){let b=a.data;h(b.hash,b.result)}),b.event=!0)},f=function(){e(),b.startAll()},g=function(){if(null==b)return void console.warn("The process "+a+" has no Worker !");let c=new Future;b.postMessage(a);let d=function(a){let d=a.data;c.value=d.result,h(d.hash,d.result),!0==b.last&&b.terminate()};return b.event||(b.addEventListener("message",d),b.event=!0),c},h=function(a,c){b.functions[a](c)}},pool=new WorkerPool(__("async/workers/function_worker.js"),2),Parsing=new WorkerPool(__("async/workers/parser_worker.js"),6),CatalogResult=function(a){this.data=a||[],Object.defineProperty(this,"size",{get:function(){return this.data.length}}),this.forEach=this.data.forEach,this.add=function(a){this.data[a]||this.data.push(a)},this.merge=function(a){a.forEach(this.add.bind(this))},this.get=function(a,b){let c=a*b;return this.data.slice(c,c+ +a)},this.preload=function(){this.forEach(a=>{Cache.has(a.path)||getText(_a(a.path+".txt")).loaded(function(b){new Process(new AsyncParse(b)).pool(Parsing).done(function(b){Cache.set(a.path,b)}).start()}).send()})},this.thenCategory=a=>{if("all"==a)return;let b=[];this.data.forEach(c=>{let d,e=!1;e=!(0<a.exclude.length)||testExclude(c.categories,a.exclude),d=!(0<a.include.length)||testInclude(c.categories,a.include),d&&e&&b.push(c)}),this.data=b},this.thenTags=a=>{let b=[];this.data.forEach(c=>{("all"==a||testExclude(c.tags,a.exclude)&&testInclude(c.tags,a.include))&&b.push(c)}),this.data=b},this.thenTitle=a=>{let b=[];this.data.forEach(c=>{let d=a.split(" ");sentenceContains(c.title,d)&&b.push(c)}),this.data=b},this.thenDate=a=>{let b=[];this.data.forEach(c=>{testIncorrectDate(c.date,a)&&b.push(c)}),this.data=b}},Catalog={date:function(){let a=new Date;return Date.parse([a.getFullYear(),a.getMonth(),a.getDate()].join(" "))}(),getMetaKey:function(a){return Catalog.keys[a]},templates:{}},sentenceContains=function(a,b){a=a.toLowerCase();for(let c,d=0;d<b.length;d++)if(c=b[d].toLowerCase(),a.includes(c))return!0;return!1},arrayContains=function(a,b){a.sort(),b.sort();for(let c=0;c<a.length;c++)for(let d=0;d<b.length;d++)if(a[c]&&b[d]&&a[c]==b[d])return!0;return!1},testInclude=function(a,b){return arrayContains(a,b)},testExclude=function(a,b){return!arrayContains(a,b)};getJson(_a("_catalog.json"),!0).loaded(function(a){Catalog.title=a.t,Catalog.metas=a.m,Catalog.keys=a.k,Catalog.dated=a.d,Catalog.undated=a.u;var b=function(a,b){let e=new CatalogResult,f=b.state.include&&b.state.include.includes("undated")?"undated":"dated";return"undated"==f?e.merge(d(a,b)):e.merge(c(a,b)),e},c=function(a,b){let c=Object.keys(Catalog.dated).sort(Sorting.reverse),f=[],g=1;for(let h in c){h=c[h];let d=Object.keys(Catalog.dated[h]).sort(Sorting.reverse);for(let c in d){c=d[c];let i=Object.keys(Catalog.dated[h][c]).sort(Sorting.reverse);for(let j in i)if(j=i[j],!(b&&e([h,c,j],b)))for(let b in Catalog.dated[h][c][j]){let d={},e=Catalog.dated[h][c][j][b];d.shortname=d.slug=b,d.title=e.t,d.path=[h,c,j,b].join("-"),d.cache=e._,d.date=[h,c,j],d.categories=e.m.c?e.m.c.map(function(a){return Catalog.keys.c[a]}).filter(a=>a):[],d.tags=e.m.t?e.m.t.map(function(a){return Catalog.keys.t[a]}).filter(a=>a):[],d.metas=e.m,a(d)&&(d.id=g++,f.push(d))}}}return f},d=function(a){let b=[],c=1;for(let d in Catalog.undated){let e={},f=Catalog.undated[d];e.title=f.t,e.shortname=e.slug=e.path=d.toString(),e.cache=f._,e.categories=f.m.c?f.m.c.map(function(a){return Catalog.keys.c[a]}).filter(a=>a):[],e.tags=f.m.t?f.m.t.map(function(a){return Catalog.keys.t[a]}).filter(a=>a):[],e.metas=f.m,a(e)&&(e.id=c++,b.push(e))}return b},e=function(a,b){let c=b.after?Date.parse(b.after.join(" ")):0,d=b.before?Date.parse(b.before.join(" ")):Date.now(),e=Date.parse(a.join(" ")),f=!1;return(e<c||e>d)&&(f=!0),f};Catalog.queryResult=function(a){let c=b(function(){return!0},a);return a.cat instanceof QueryArgument&&c.thenCategory(a.cat),a.tag instanceof QueryArgument&&c.thenTags(a.tag),0<a.text.trim().length&&c.thenTitle(a.text),c},initFrog()}).send();var TemplateTypes=function(){let a=function(a){this.toString=()=>a},b=function(a){return a=a.toUpperCase(),a===b.PAGINATION.toString()?b.PAGINATION:a===b.ARTICLE.toString()?b.ARTICLE:b.GADGET};return b.GADGET=new a("GADGET"),b.ARTICLE=new a("ARTICLE"),b.PAGINATION=new a("PAGINATION"),b}(),TemplateExpressions=function(){var a={regexp:/\{\s*(\?|if|\:|for|include|\+|)\s*([^}]+?)\s*\}/gm},b={"<=":"le",">=":"ge","<":"lt",">":"gt","=":"eq","!":"ne","~":"has"},c=function(a){let c=/(.+)\s+(lte|gte|lt|gt|eq|ne|has)\s+(.+)\s*/gm.exec(a);if(c||(c=/(.+)\s*(<=|>=|<|>|=|!|~)\s*(.+)\s*/gm.exec(a)),c){let a=c[1],d=b[c[2]]||c[2],e=c[3].trim();return"ft=\"if\" fto=\""+d+"\" ftp-"+a+"=\""+e+"\""}return"ft=\"if\" fto=\"set\" ftp-"+a},d=function(a){let b=/\s*(.+)\s+in\s+(.+)\s*/gm.exec(a);if(b||(b=/\s*(.+)\s*=\s*(.+)\s*/gm.exec(a)),b){let a=b[1].trim(),c=b[2].trim(),d=Number.parseInt(c);return Number.isNaN(d)?"ft=\"for\" ftf=\""+a+"\" ftli=\""+c+"\"":"ft=\"for\" ftf=\""+a+"\" ftlr=\""+d+"\""}return""},e=function(a){return a=a.toLowerCase(),"<span ft=\"node\" ftn-"+a+"></span>"},f=function(a){return(a=a.toLowerCase(),"title"==a)?Catalog.title:Catalog.metas[a]?Catalog.metas[a]:void 0},g=function(a,b){return"fta-"+b.toLowerCase()+"=\""+a+"\""},h=function(a){let b;return getText(_t(a+".html"),!0).loaded(function(a){b=new Template(a).body}).send(),b};return a.replacer=function(a,b,i){if("?"==b||"if"==b)return c(i);if(":"==b||"for"==b)return d(i);if("include"==b||"+"==b)return h(i);else{let a=/(.+)\s*=\s*(.+)\s*/gm.exec(i);if(a){let b=a[1].trim(),c=a[2].trim();return c[0]==c[0].toUpperCase()?b+"=\""+f(c)+"\"":g(b,c)}return i[0]==i[0].toUpperCase()?f(i):e(i)}},a.parse=function(b){return b.replace(a.regexp,a.replacer)},a}(),Template=function(a){a=a.replace(/^#\s*(\w*)+?(?:\s*('|")(\w*?)\2)?\s*/g,(a,b,c,d)=>(this.type=TemplateTypes(b),this.name=d||!1,"")),a=a.replace(/^\s*\/\/.*$/gm,""),a=TemplateExpressions.parse(a),this.body=a,this.get=function(){let b=document.createElement("div");return b.innerHTML=a,b}};Template.get=function(a){if(!Cache.has(a)){var b;return getText(a,!0).loaded(function(c){b=new Template(c),Cache.set(a,c)}).send(),b}return b=new Template(Cache.get(a,b)),b};var Article=function(a){let b=a.get(),c=b.firstElementChild,d=b.querySelectorAll("[ft=\"if\"]");for(let b=0;b<d.length;b++)d[b].style.display="none";c.clean=function(){let a=c.querySelectorAll("[ft]");for(let b,c=0;c<a.length;c++)b=a[c].getAttribute("ft"),"if"==b&&a[c].remove()},c.set=function(a,d){h(b,a)&&j(b,a,d),k(c,a)&&l(c,a,d),e(b,a)&&f(b,a,d),m(),n(a,d)};var e=function(a,b){var c=a.querySelector("[ft=\"if\"][ftp-"+b+"]");return!!c},f=function(b,c,a){let d=b.querySelectorAll("[ft=\"if\"][ftp-"+c+"]");for(let e,f=0;f<d.length;f++)if(e=d[f].getAttribute("fto"),"set"==e||""==e)d[f].removeAttribute("ftp-"+c),d[f].removeAttribute("fto"),d[f].removeAttribute("ft"),d[f].style.display="";else{let b=d[f].getAttribute("ftp-"+c);g(a,e,b)?(d[f].style.display="",d[f].removeAttribute("ftp-"+c),d[f].removeAttribute("fto"),d[f].removeAttribute("ft")):d[f].remove()}},g=function(a,b,c){switch(b){case"eq":return a==c;case"ne":return a!=c;case"lt":return a<c;case"gt":return a>c;case"le":return a<=c;case"ge":return a>=c;case"has":if(a instanceof Object)return!!a[c];try{a.includes(c)}catch(a){}default:}return!1},h=function(a,b){var c=a.querySelector("[fta-"+b+"]");return!!c},j=function(b,c,a){let d=b.querySelectorAll("[fta-"+c+"]");for(let e=0;e<d.length;e++){let b=d[e].getAttribute("fta-"+c),f=d[e].getAttribute(b)||"";d[e].setAttribute(b,(f?f+" ":"")+a),d[e].removeAttribute("fta-"+c)}},k=function(a,b){var c=a.querySelector("[ftn-"+b+"]");return!!c},l=function(b,c,a){let d=b.querySelectorAll("[ftn-"+c+"]");for(let e=0;e<d.length;e++)d[e].replace(a)},m=function(){let a=c.querySelectorAll("[ft=\"for\"][ftlr]");for(let b=0;b<a.length;b++){let c=a[b].getAttribute("ftf"),d=a[b].getAttribute("ftlr"),g=a[b].firstElementChild.cloneNode(!0);a[b].innerHTML="";for(let i,m=1;m<=d;m++)i=g.cloneNode(!0),h(i,c)&&j(i,c,m),k(i,c)&&l(i,c,m),e(i,c)&&f(i,c,m),1==m&&(h(i,"FIRST")&&j(i,"FIRST",!0),k(i,"FIRST")&&l(i,"FIRST",!0),e(i,"FIRST")&&f(i,"FIRST",!0)),m==d&&(h(i,"LAST")&&j(i,"LAST",!0),k(i,"LAST")&&l(i,"LAST",!0),e(i,"LAST")&&f(i,"LAST",!0)),a[b].appendChild(i);a[b].removeAttribute("ft"),a[b].removeAttribute("ftf"),a[b].removeAttribute("ftlr")}},n=function(a,b){let d=c.querySelectorAll("[ft=\"for\"][ftli=\""+a+"\"]");for(let c=0;c<d.length;c++){if(!b.length||0==b.length)return void d[c].remove();let a=d[c].getAttribute("ftf"),g=d[c].firstElementChild.cloneNode(!0);d[c].innerHTML="";let i=1;for(let m of b){let n=g.cloneNode(!0);h(n,a)&&j(n,a,m),k(n,a)&&l(n,a,m),e(n,a)&&f(n,a,m),1==i&&(h(n,"FIRST")&&j(n,"FIRST",!0),k(n,"FIRST")&&l(n,"FIRST",!0),e(n,"FIRST")&&f(n,"FIRST",!0)),i==b.length&&(h(n,"LAST")&&j(n,"LAST",!0),k(n,"LAST")&&l(n,"LAST",!0),e(n,"LAST")&&f(n,"LAST",!0)),d[c].appendChild(n),i++}d[c].removeAttribute("ft"),d[c].removeAttribute("ftf"),d[c].removeAttribute("ftli")}};return c},QueryDate=function(a,b){if("string"!=typeof b||0==b.length)return;if("string"!=typeof a||0==a.length)return;let c=[];(function(){let a=b.split(/-| /);a.forEach(a=>{switch(a[a.length-1]){case"Y":case"y":c[0]=a.substring(0,a.length-1);break;case"M":case"m":c[1]=a.substring(0,a.length-1);break;case"D":case"d":c[2]=a.substring(0,a.length-1);break;default:c.push(a);}})})();let d=immutableProperty.bind(c);d("argument",a);return c.toString=function(){return a+"("+b+")"},c},QueryArgument=function(a,b){if("string"==typeof b&&0!=b.length&&"string"==typeof a&&0!=a.length){this.include=[],this.exclude=[];b.trim().replace(/([^ ,]+)/g,(a,b)=>{"-"==b[0]?this.exclude.push(b.substr(1)):this.include.push(b)});let c=immutableProperty.bind(this);c("argument",a),this.toString=function(){return a+"("+b+")"}}},Query=function a(b){"string"!=typeof b||0==b.length||(this.reset=()=>{this.cat=this.tag=this.after=this.before=this.state=[],this.text="",b=""},this.set=c=>{c instanceof a&&(this.cat=c.cat,this.tag=c.tag,this.text=c.text,this.after=c.after,this.before=c.before,this.state=c.state,b=c.toString())},this.parse=a=>{this.reset(),b=a,a=a.replace(/(\w+)\(([^\()]+)\)/g,(d,a,b)=>(this[a]="after"===a||"before"===a?new QueryDate(a,b.replaceParams()):"state"==a?new QueryArgument(a,b.replaceParams()):new QueryArgument(a,b.replaceParams()),"")),this.text=a.trim()||""},this.toString=()=>{if(0==b.length){let a=this.text;a+=" "+this.cat.toString(),a+=" "+this.tag.toString(),a+=" "+this.before.toString(),a+=" "+this.after.toString(),a+=" "+this.state.toString(),b=a}return b},b?this.parse(b):this.reset())},PaginationLink=function(a,b,c){b=Math.max(0,Math.min(a.pages,b));let d=document.createElement("span");return d.innerHTML=c,b!=a.page&&(d.addEventListener("click",()=>{a.goToPage(b)}),d.className="a"),d},pageLinks=function(a,b){let c=b.pages,d=document.createElement("span"),e=9<c?9:c,f=Math.min(b.page,c),g=4<f?Math.min(c-8,f-4):0;for(let c=0;c<e+1;c++)d.appendChild(createPageLink(a,g+c));return d},Pagination=function(a,b=!1){let c=document.createElement("nav");c.className="frog-pagination",c.goToPage=a.goToPage,c.appendChild(new PaginationLink(a,0,"&lt;&lt;")),c.appendChild(new PaginationLink(a,a.page-1,"&lt;"));for(let d=0;d<=a.pages;d++)c.appendChild(new PaginationLink(a,d,""+(d+1)));return c.appendChild(new PaginationLink(a,a.page+1,"&gt;")),c.appendChild(new PaginationLink(a,a.pages,"&gt;&gt;")),c};function getAttributes(a){let b=a.element,c={flow:OPTIONS.TEMPLATE,perpage:OPTIONS.PERPAGE,pagination:OPTIONS.PAGINATION,state:OPTIONS.STATE};if(b.hasAttribute("preset")){let a=window[b.getAttribute("preset")]||{};Object.assign(c,a)}let d=b.getAttributeNames();return d.forEach(a=>{c[a]=a.startsWith("on")?window[b.getAttribute(a)]:b.getAttribute(a)}),c}var initElement=function(a){a.classList?a.classList.add("frog-flow"):a.className+="frog-flow"},cleanElement=function(b){["flow","cat","tag","text","query","max","page","perpage","hash","scroll","pagination","post","state","loaded"].forEach(c=>{b.removeAttribute(c)})},extractQuery=function(a){let b=a.query?a.query:"";return""===b&&(b+="".replaceParams.call(a.text?a.text:" "),["cat","tag"].forEach(c=>{let d="".replaceParams.call(a[c]?a[c]:"");0<d.length&&(b+=" "+c+"("+d+")")})),["state"].forEach(c=>{let d="".replaceParams.call(a[c]?a[c]:"");0<d.length&&(b+=" "+c+"("+d+")")}),b},readPagination=function(a){let b={position:"bottom",target:void 0,template:void 0},c=a.getAttribute("frog-pagination")||!1;return c&&c.split(" ").forEach(a=>{let c;"both"===a||"top"===a?b.position=a:(c=/<([^>]+)>/.exec(a))?b.target=document.getElementById(c[1]):(c=/\(([^>]+)\)/.exec(a))&&(b.template=Template.get(_t(c[1]+".html")))}),b};function addLoading(a){let b=a.element,c=b.offsetHeight;b.style.minHeight=c+"px",b.style.maxHeight=c+"px",b.style.opacity="0.7",b.style.overflow="hidden"}function removeLoading(a){let b=a.element;b.style.minHeight="0px",b.style.maxHeight="none",b.style.opacity="1",b.style.overflow="auto"}var Flow=function(a,b=""){let c=this;initElement(a),this.element=a,this.id=a.id||"flow"+FROG.FLOWS;let d=getAttributes(this),e=immutableProperty.bind(this),f=hookedProperty.bind(this,this.refresh);f("template",d.flow),f("max",d.max),f("perpage",d.perpage);let g=extractQuery(d);e("Query",new Query(g)),Object.defineProperty(this,"query",{set:a=>{g=a,this.Query.parse(a),o(this.Query),this.refresh()},get:()=>g}),readPagination(a);let h=d.pagination;e("pagination",["top","bottom","both","none"].includes(h)?h:OPTIONS.PAGINATION),e("scroll",d.scroll),e("post",d.post),e("preload",d.preload),e("onLoaded",d.loaded);let i=function(a){return Math.max(0,Math.min(k,a))},j=a.getAttribute("page")||UrlHash.get(this.id)||0;Object.defineProperty(this,"page",{set:a=>{this.goToPage(a)},get:()=>j}),this.goToPage=a=>{j=i(a),UrlHash.set(this.id,j),this.refresh()},this.next=()=>{this.goToPage(i(j+1))},this.previous=()=>{this.goToPage(i(j-1))};let k=0;this.last=()=>{this.goToPage(k)},this.first=()=>{this.goToPage(0)},Object.defineProperty(this,"pages",{get:()=>k}),cleanElement(a);let l,m,n=Template.get(_t(this.template+".html"));var o=()=>{l=Catalog.queryResult(this.Query),m=l.size,k=Math.floor((m-1)/this.perpage)};o(this.Query);var p=b=>{let e=Article(n,_a(b.path+".json"));if(d.folder&&(b.path=d.folder+"/"+b.path),b.date&&e.set("date",b.date.join("-")),b.title&&e.set("title",b.title),b.categories&&e.set("classes","frog "+(b.categories.join(" ")+" "+b.tags.join(" ")).trim()),b.categories&&e.set("categories",b.categories),b.id&&e.set("id",b.id),b.slug&&e.set("slug",b.slug),b.slug&&e.set("slug_id",b.slug+"_"+b.id),b.path&&e.set("path",b.path),b.slug&&e.set("link","single.html#art="+b.slug),b.metas){let a=Object.keys(b.metas);a.forEach(a=>{if(+a){let c=Catalog.getMetaKey(a);e.set(c,b.metas[a])}})}a.appendChild(e),this.post&&window[this.post](e);let f=!!Cache.has(b.path)&&Cache.get(b.path);return f&&f.key==b.cache?void(e.set("content",JSON.parse(f).data),e.clean(),removeLoading(c)):getText(_a(b.path+".txt")).loaded(function(a){new Process(new AsyncParse(a)).pool(Parsing).done(function(a){e.set("content",a),e.clean(),removeLoading(c);let d=JSON.stringify({key:b.cache,data:a});Cache.set(b.path,d)}).start()}).send()};let q=[];return Object.defineProperty(this,"result",{get:()=>l}),Object.defineProperty(this,"size",{get:()=>l.size}),this.refresh=()=>{q=l.get(this.perpage,this.page),addLoading(c),a.innerHTML="";let b=new FuturePool;q.forEach(a=>{b.add(p(a))}),b.setTimeout(1e4,()=>{d.timeout&&window[d.timeout](this)}).done(()=>{d.loaded&&window[d.loaded](this)}),l.size>this.perpage&&"none"!=this.pagination&&(("both"==this.pagination||"top"==this.pagination)&&a.prepend(Pagination(this)),("both"==this.pagination||"bottom"==this.pagination)&&a.appendChild(Pagination(this)),(this.page>this.pages||0>this.page)&&this.goToPage(i(this.page)))},this.element.frog=this,this.preload&&l.preload(),this.refresh(),this};function Gadget(a){let b=a.element,c=a.template,d=Template.get(_t(c+".html")).get().firstElementChild;d&&(b.textContent="",b.parentNode.insertBefore(d,b))}function processGadgets(){for(var a,b=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,!1);a=b.nextNode();){let b=a.data.match(/\{.+\}/g);b&&b.forEach(b=>{let c;if(c=/\s*\{\s*frog(?:-include|\s*\+)\s*(.+)\s*\}/g.exec(b)){let b={template:c[1].trim(),element:a};new Gadget(b)}})}}function Insert(a){let b=a.element,c=a.key,d="";"title"==c?d=Catalog.title:Catalog.metas[c]&&(d=Catalog.metas[c]),b.textContent=d}function processInserts(){for(var a,b=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,!1);a=b.nextNode();){let b;if(b=a.data.match(/\s*\{\s*frog\s+(.+)\s*\}/)){let c={key:b[1].trim(),element:a};new Insert(c)}}for(b=document.createTreeWalker(document,NodeFilter.SHOW_TEXT,null,!1);a=b.nextNode();){let b;if(b=a.data.match(/\s*\{\s*frog\s+(.+)\s*\}/)){let c={key:b[1].trim(),element:a};new Insert(c)}}}function doGadgets(){processGadgets(),processInserts()}function doFlows(){let a=document.querySelectorAll("[frog]");for(let b,c=0;c<a.length;c++)b=a[c],new Flow(b)}var initFrog=function(){doFlows(),doGadgets()};window.onload=function(){initFrog();let a=document.getElementById("FROGLOADER");a&&a.classList.add("remove")},window.onunload=function(){let a=document.getElementById("FROGLOADER");a&&a.classList.remove("remove")};